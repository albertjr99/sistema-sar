{% extends 'base.html' %}
{% block conteudo %}
<h2>Distribuição Histórica</h2>

<form class="row g-2 mb-3 no-print">
  <div class="col-md-2"><input class="form-control" name="ano" placeholder="Ano" value="{{ request.args.get('ano','') }}"></div>
  <div class="col-md-2"><input class="form-control" name="mes" placeholder="Mês (1..12)" value="{{ request.args.get('mes','') }}"></div>
  <div class="col-md-3"><input class="form-control" name="analista" placeholder="Analista" value="{{ request.args.get('analista','') }}"></div>
  <div class="col-md-2 d-grid"><button class="btn btn-primary">Filtrar</button></div>
  <div class="col-md-3 d-grid"><a class="btn btn-success" href="{{ url_for('distribuicao_exportar', **request.args) }}">Exportar Excel</a></div>
</form>

<div class="table-responsive">
  <table class="table table-sm table-striped">
    <thead>
      <tr>
        <th>Ano</th><th>Mês</th><th>Ordem</th><th>Analista</th><th>Número</th><th>Data</th>
        <th>Interessado</th><th>Assunto</th><th>Setor Origem</th><th>Tipo</th><th>Distribuição</th><th>Conclusão</th>
      </tr>
    </thead>
    <tbody>
      {% for r in (linhas or []) %}
      <tr>
        <td>{{ r.ano }}</td>
        <td>{{ r.mes }}</td>
        <td>{{ r.ordem_geral }}</td>
        <td>{{ r.analista }}</td>
        <td>{{ r.numero }}</td>
        <td>{{ r.data and r.data.strftime('%d/%m/%Y') }}</td>
        <td>{{ r.interessado }}</td>
        <td>{{ r.assunto }}</td>
        <td>{{ r.setor_origem }}</td>
        <td>{{ r.tipo_processo }}</td>
        <td>{{ r.data_distribuicao and r.data_distribuicao.strftime('%d/%m/%Y') }}</td>
        <td>{{ r.data_conclusao and r.data_conclusao.strftime('%d/%m/%Y') }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
