{% extends 'base.html' %}
{% block conteudo %}
<h2>Hist√≥rico</h2>

<div class="d-flex gap-2 mb-3 no-print">
  <form action="{{ url_for('historico_importar') }}" method="post" enctype="multipart/form-data" class="d-flex gap-2">
    <input type="file" name="arquivo" accept=".xlsx" class="form-control form-control-sm" required>
    <button class="btn btn-sm btn-outline-secondary">Importar planilha</button>
  </form>
  <a class="btn btn-sm btn-success" href="{{ url_for('historico_exportar') }}">Exportar Excel</a>
</div>

<div class="table-responsive">
  <table class="table table-sm table-striped">
    <thead>
      {% if linhas and linhas[0] %}
      <tr>
        {% for k in linhas[0].keys() %}<th>{{ k }}</th>{% endfor %}
      </tr>
      {% endif %}
    </thead>
    <tbody>
      {% for d in (linhas or []) %}
      <tr>
        {% for v in d.values() %}<td>{{ v }}</td>{% endfor %}
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
